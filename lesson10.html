<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 10: æœ€å¾Œçš„é˜²ç·šâ€”â€”è®Šä½ç›£æ¸¬èˆ‡ç«£å·¥æ¸¬é‡</title>
    <style>
        :root {
            --bg-theory: #fdf2f8; /* è­¦ç¤ºç´…ç²‰è‰²èª¿ */
            --bg-field: #fffaf0;
            --bg-tool: #000000; /* å…¨é»‘ç›£æ§å®¤é¢¨æ ¼ */
            --text-main: #334155;
            --text-light: #f8fafc;
            --accent-alert: #dc2626; /* è­¦å ±ç´… */
            --accent-safe: #10b981; /* å®‰å…¨ç¶  */
            --accent-warn: #f59e0b; /* è­¦å‘Šé»ƒ */
            --border-color: #cbd5e1;
            --tech-mono: 'Courier New', monospace;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: "Microsoft JhengHei", "Segoe UI", sans-serif;
            background-color: #f8fafc;
            color: var(--text-main);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            width: 98%;
            max-width: 1920px;
            margin: 0 auto;
            padding: 20px 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }

        header {
            grid-column: 1 / -1;
            background: white;
            padding: 2rem;
            border-bottom: 4px solid var(--accent-alert);
            margin-bottom: 10px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1 { font-size: 36px; font-weight: 800; color: #1e293b; letter-spacing: -0.025em; }
        h2 { font-size: 28px; margin-top: 1.5rem; margin-bottom: 1rem; border-left: 5px solid; padding-left: 15px; }
        p, li { font-size: 22px; margin-bottom: 1rem; text-align: justify; }

        /* å·¦æ¬„ */
        .theory-column {
            background-color: var(--bg-theory);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .theory-column h2 { border-color: var(--accent-alert); color: #991b1b; }

        /* å³æ¬„ */
        .field-column { display: flex; flex-direction: column; gap: 20px; }
        .field-panel {
            background-color: var(--bg-field);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .field-panel h2 { border-color: var(--accent-warn); color: #b45309; }

        /* å·¥å…·é¢æ¿ */
        .tool-panel {
            background-color: var(--bg-tool);
            color: var(--text-light);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.6);
            position: sticky;
            top: 20px;
            border: 1px solid #333;
        }
        .tool-panel h2 { border-color: var(--accent-alert); color: var(--accent-alert); text-transform: uppercase; letter-spacing: 2px; }

        /* SVG */
        .svg-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        /* æ•¸å­¸å¡ç‰‡ */
        .math-card {
            background: white;
            padding: 20px;
            border-left: 4px solid var(--accent-alert);
            font-family: "Times New Roman", serif;
            font-style: italic;
            font-size: 24px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* è¼¸å…¥ä»‹é¢ */
        .monitor-grid {
            display: grid; grid-template-columns: 1fr 1fr 100px; gap: 10px; margin-bottom: 10px;
            background: #111; padding: 10px; border-radius: 4px; border: 1px solid #333;
        }
        label { display: block; font-size: 12px; margin-bottom: 5px; color: #64748b; }
        input {
            width: 100%; padding: 8px; background: #222; border: 1px solid #444;
            color: var(--accent-safe); border-radius: 4px; font-size: 16px; font-family: var(--tech-mono);
        }
        input:focus { outline: 1px solid var(--accent-safe); }

        .btn {
            background: #b91c1c;
            color: white; border: none; padding: 15px;
            font-size: 18px; border-radius: 4px; cursor: pointer; width: 100%; font-weight: bold;
            font-family: var(--tech-mono); text-transform: uppercase;
            transition: background 0.2s;
        }
        .btn:hover { background: #dc2626; }
        .btn-add { background: #334155; margin-bottom: 15px; padding: 10px; font-size: 14px; }

        /* ç›£æ§å„€è¡¨æ¿é¡¯ç¤º */
        .dashboard-screen {
            margin-top: 20px;
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
        }
        .stat-box {
            background: #111; border: 1px solid #333; padding: 15px; border-radius: 4px;
            text-align: center;
        }
        .stat-val { font-size: 28px; font-weight: bold; font-family: var(--tech-mono); display: block; margin-top: 5px;}
        .status-ok { color: var(--accent-safe); }
        .status-warn { color: var(--accent-warn); animation: pulse 2s infinite; }
        .status-danger { color: var(--accent-alert); animation: blink 0.5s infinite; }

        @keyframes blink { 0% {opacity:1;} 50% {opacity:0.3;} 100% {opacity:1;} }
        @keyframes pulse { 0% {opacity:1;} 50% {opacity:0.6;} 100% {opacity:1;} }

        @media (max-width: 1200px) {
            .container { grid-template-columns: 1fr; }
            .tool-panel { position: static; }
        }
    </style>
</head>
<body>

<header>
    <h1>Lesson 10: æœ€å¾Œçš„é˜²ç·š â€” è®Šä½ç›£æ¸¬èˆ‡ç«£å·¥æ¸¬é‡</h1>
    <p style="color: #64748b; font-size: 18px; margin-bottom: 0;">Road to Expert: æ©‹æ¨‘æœƒèªªè©±ã€‚ä½ çš„ä»»å‹™æ˜¯è½æ‡‚å®ƒçš„èªè¨€ï¼šè¶¨å‹¢ã€é€Ÿç‡èˆ‡åŠ é€Ÿåº¦ã€‚</p>
</header>

<div class="container">
    <div class="theory-column">
        
        <h2>ğŸ¥ ç›´è§€è­¬å–»ï¼šçµæ§‹çš„å¿ƒé›»åœ–</h2>
        <p>ç›£æ¸¬æ•¸æ“šå°±æ˜¯æ©‹æ¨‘çš„å¿ƒé›»åœ–ã€‚</p>
        <p>1. <strong>ç©©å®šå‹ (Stable)ï¼š</strong> å°±åƒå¹³ç©©çš„å¿ƒè·³ã€‚æ•¸æ“šåœ¨ä¸€å€‹å°ç¯„åœå…§æ³¢å‹•ï¼ˆå—æº«åº¦å½±éŸ¿ï¼‰ï¼Œä½†é•·æœŸè¶¨å‹¢æ˜¯æ°´å¹³çš„ã€‚é€™æ˜¯å¥åº·çš„æ©‹ã€‚
        <br>2. <strong>æ”¶æ–‚å‹ (Converging)ï¼š</strong> åƒå‰›è·‘å®Œæ­¥å¿ƒè·³é€æ¼¸æ…¢ä¸‹ä¾†ã€‚æ–°å»ºæ©‹æ¨‘å‰›é€šè»Šæ™‚ï¼Œæ²‰é™·é‡æœƒè¼ƒå¤§ï¼Œä½†éš¨è‘—æ™‚é–“æ¨ç§»ï¼Œæ²‰é™·é€Ÿç‡è¶Šä¾†è¶Šæ…¢ï¼Œæœ€çµ‚è¶¨æ–¼ç©©å®šã€‚
        <br>3. <strong>ç™¼æ•£å‹ (Diverging)ï¼š</strong> é€™æ˜¯å¿ƒå®¤é¡«å‹•çš„å‰å…†ï¼å¦‚æœä½ ç™¼ç¾æ²‰é™·é€Ÿç‡ã€Œè¶Šä¾†è¶Šå¿«ã€ï¼ˆåŠ é€Ÿåº¦ç‚ºæ­£ï¼‰ï¼Œä»£è¡¨çµæ§‹æ­£åœ¨å´©æ½°ï¼Œå¿…é ˆç«‹å³å°æ©‹ã€‚</p>

        <h2>ğŸ“‰ è¦–è¦ºåœ–è§£ï¼šæ™‚é–“-æ²‰é™·æ›²ç·š (Time-Settlement Curve)</h2>
        <div class="svg-container">
            <svg viewBox="0 0 800 350" xmlns="http://www.w3.org/2000/svg">
                <line x1="50" y1="50" x2="50" y2="300" stroke="#333" stroke-width="2"/>
                <line x1="50" y1="50" x2="750" y2="50" stroke="#333" stroke-width="2"/>
                <text x="760" y="55" font-size="14">æ™‚é–“ (t)</text>
                <text x="30" y="320" font-size="14" writing-mode="tb">æ²‰é™·é‡ (S)</text>

                <path d="M 50 50 Q 200 150 700 160" fill="none" stroke="#10b981" stroke-width="3"/>
                <text x="710" y="165" fill="#10b981" font-weight="bold">å®‰å…¨ (æ”¶æ–‚)</text>

                <line x1="50" y1="50" x2="700" y2="250" stroke="#f59e0b" stroke-width="3" stroke-dasharray="5"/>
                <text x="710" y="255" fill="#f59e0b" font-weight="bold">è­¦æˆ’ (ç­‰é€Ÿ)</text>

                <path d="M 50 50 Q 400 100 600 320" fill="none" stroke="#dc2626" stroke-width="4"/>
                <text x="610" y="320" fill="#dc2626" font-weight="bold">å±éšª (åŠ é€Ÿ)</text>

                <line x1="50" y1="200" x2="750" y2="200" stroke="#94a3b8" stroke-dasharray="2"/>
                <text x="60" y="195" fill="#94a3b8" font-size="12">ç®¡ç†å€¼ (Action Level)</text>
            </svg>
            <p style="font-size: 16px; color: #64748b; margin-top: 10px;">åœ–è§£ï¼šä¸ç®¡ç´¯ç©æ²‰é™·é‡å¤šå°‘ï¼Œæˆ‘å€‘æœ€æ€•çš„æ˜¯ç´…ç·šâ€”â€”é€Ÿç‡è¶Šä¾†è¶Šå¿«ï¼Œé€™ä»£è¡¨åœŸå£¤å·²ç¶“å¤±å»æ‰¿è¼‰åŠ›ã€‚</p>
        </div>

        <h2>ğŸ§® ç¡¬æ ¸ç†è«–ï¼šé€Ÿç‡åˆ†æ</h2>
        <p>å–®çœ‹ç´¯ç©æ²‰é™·é‡ $S$ æ˜¯ä¸å¤ çš„ï¼Œæˆ‘å€‘å¿…é ˆçœ‹å¾®åˆ†ã€‚</p>
        <div class="math-card">
            v = \frac{\Delta S}{\Delta t}, \quad a = \frac{\Delta v}{\Delta t}
        </div>
        <ul>
            <li><strong>æ²‰é™·é€Ÿç‡ $v$ (mm/day)ï¼š</strong> å¦‚æœ $v$ æŒçºŒå¤§æ–¼ 2mm/day ä¸”ä¸æ¸›ç·©ï¼Œå³ç‚ºç•°å¸¸ã€‚</li>
            <li><strong>æ²‰é™·åŠ é€Ÿåº¦ $a$ï¼š</strong> 
                <br>è‹¥ $a < 0$ (è² å€¼)ï¼šé€Ÿç‡è®Šæ…¢ï¼Œè¶¨æ–¼ç©©å®š (Safe)ã€‚
                <br>è‹¥ $a > 0$ (æ­£å€¼)ï¼šé€Ÿç‡è®Šå¿«ï¼Œçµæ§‹æ­£åœ¨èµ°å‘ç ´å£ (Danger)ã€‚
            </li>
        </ul>
        <p><strong>å›æ­¸åˆ†æé æ¸¬ï¼š</strong>
        <br>åˆ©ç”¨å°æ•¸å‡½æ•¸ $S(t) = a + b \ln(t)$ ä¾†æ“¬åˆæ”¶æ–‚æ›²ç·šã€‚å¦‚æœå¯¦éš›è§€æ¸¬å€¼åé›¢é€™æ¢é æ¸¬ç·šä¸¦å‘ä¸Šç¿¹èµ·ï¼Œå°±æ˜¯è­¦è¨Šã€‚</p>
    </div>

    <div class="field-column">
        
        <div class="field-panel">
            <h2>ğŸ‘· ä¸»ä»»çš„å°è¬›æ©Ÿï¼šèª°åœ¨èªªè¬Šï¼Ÿ</h2>
            
            <h3>1. åŸºæº–é» (Bench Mark) çš„èƒŒå›</h3>
            <p>ç•¶ä½ ç™¼ç¾æ©‹æ¨‘ä¸‹æ²‰äº† 5mmï¼Œæœ‰æ²’æœ‰å¯èƒ½å…¶å¯¦æ˜¯<strong>ä½ çš„åŸºæº–é» (BM) ä¸Šå‡äº† 5mmï¼Ÿ</strong>
            <br>é€™åœ¨å·¥åœ°æ¥µç‚ºå¸¸è¦‹ã€‚é‡è»Šç¶“éã€å †ç½®åœŸæ–¹éƒ½æœƒå½±éŸ¿åŸºæº–é»ã€‚
            <br><strong>éµå‰‡ï¼š</strong> ç›£æ¸¬ç¶²å¿…é ˆåŒ…å«è‡³å°‘ 3 å€‹ä½æ–¼å·¥å€å¤– 500m ä»¥ä¸Šçš„ã€Œæ·±å±¤å²©ç›¤æ¨ã€ä½œç‚ºçµ•å°æ§åˆ¶é»ã€‚æ¯æ¬¡ç›£æ¸¬å‰ï¼Œå…ˆæª¢æ ¸é€™ 3 é»æ˜¯å¦ç›¸å°ç©©å®šã€‚</p>

            <h3>2. ç†±è„¹å†·ç¸®çš„é›œè¨Š</h3>
            <p>é•·è·¨è·é‹¼æ©‹ï¼Œä¸­åˆå’Œæ™šä¸Šçš„é«˜ç¨‹å¯ä»¥å·®åˆ° 3-5 å…¬åˆ†ã€‚
            <br>å¦‚æœä½ æ—©ä¸Š 8 é»æ¸¬ç¬¬ä¸€æ¬¡ï¼Œä¸‹åˆ 2 é»æ¸¬ç¬¬äºŒæ¬¡ï¼Œä½ æœƒä»¥ç‚ºæ©‹å¡Œäº†ã€‚
            <br><strong>è§£æ³•ï¼š</strong> å›ºå®šæ™‚é–“æ¸¬é‡ï¼ˆä¾‹å¦‚éƒ½åœ¨æ¸…æ™¨ 6:00 ç„¡æ—¥ç…§æ™‚ï¼‰ï¼Œæˆ–è€…å»ºç«‹æº«åº¦ä¿®æ­£æ¨¡å‹ã€‚ä¸è¦è¢«å¤ªé™½é¨™äº†ã€‚</p>
        </div>

        <div class="tool-panel">
            <h2>ğŸš¨ äº’å‹•å·¥å…·ï¼šæ™ºæ…§ç›£æ¸¬æˆ°æƒ…å®¤</h2>
            <p>è¼¸å…¥æ­·æ¬¡ç›£æ¸¬æ•¸æ“šï¼Œç³»çµ±è‡ªå‹•è¨ˆç®—é€Ÿç‡è¶¨å‹¢ä¸¦ç™¼å¸ƒè­¦å ±ã€‚</p>
            
            <div style="margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px;">
                <label>ç®¡ç†å€¼è¨­å®š (Thresholds)</label>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <div>
                        <label>è­¦æˆ’å€¼ (Alert) mm/day</label>
                        <input type="number" id="limit-alert" value="1.0">
                    </div>
                    <div>
                        <label>è¡Œå‹•å€¼ (Action) mm/day</label>
                        <input type="number" id="limit-action" value="2.0">
                    </div>
                </div>
            </div>

            <div id="data-inputs">
                </div>
            
            <button class="btn btn-add" onclick="addDataRow()">+ æ–°å¢ç›£æ¸¬æ—¥ (Add Date)</button>
            <button class="btn" onclick="analyzeTrend()">âš¡ åŸ·è¡Œè¶¨å‹¢è¨ºæ–·</button>

            <div class="dashboard-screen" id="dashboard" style="display:none;">
                <div class="stat-box" style="grid-column: 1 / -1;">
                    <span class="res-label">ç³»çµ±ç‹€æ…‹ SYSTEM STATUS</span>
                    <span class="stat-val" id="sys-status">--</span>
                </div>
                <div class="stat-box">
                    <span class="res-label">ç›®å‰é€Ÿç‡ (Velocity)</span>
                    <span class="stat-val" id="curr-vel">--</span>
                    <span style="font-size:12px; color:#64748b;">mm/day</span>
                </div>
                <div class="stat-box">
                    <span class="res-label">ç´¯ç©æ²‰é™· (Total)</span>
                    <span class="stat-val" id="total-settle">--</span>
                    <span style="font-size:12px; color:#64748b;">mm</span>
                </div>
                <div class="stat-box" style="grid-column: 1 / -1; text-align:left; font-size:14px; color:#ccc;">
                    <span class="res-label">è¨ºæ–·æ—¥èªŒ LOG:</span>
                    <div id="log-content" style="margin-top:5px; font-family: monospace;"></div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    // é è¨­æ•¸æ“š (æ¨¡æ“¬åŠ é€Ÿç ´å£)
    const demoData = [
        {day: 1, val: 10.00},
        {day: 5, val: 10.50},
        {day: 10, val: 11.20},
        {day: 15, val: 12.50},
        {day: 18, val: 14.00} // æœ€å¾Œä¸‰å¤©åŠ é€Ÿ
    ];

    function init() {
        const container = document.getElementById('data-inputs');
        container.innerHTML = "";
        demoData.forEach((d, i) => {
            addDataRow(d.day, d.val);
        });
    }

    function addDataRow(dayVal = "", readingVal = "") {
        const container = document.getElementById('data-inputs');
        const div = document.createElement('div');
        div.className = 'monitor-grid';
        div.innerHTML = `
            <div>
                <label>å¤©æ•¸ (Day)</label>
                <input type="number" class="inp-day" value="${dayVal}">
            </div>
            <div>
                <label>è®€æ•¸ (Elev m)</label>
                <input type="number" class="inp-val" value="${readingVal}" step="0.001">
            </div>
            <div style="display:flex; align-items:end;">
                 <button style="background:#333; color:#fff; border:none; padding:5px; width:100%; cursor:pointer;" onclick="this.parentElement.parentElement.remove()">Del</button>
            </div>
        `;
        container.appendChild(div);
    }

    function analyzeTrend() {
        const days = document.querySelectorAll('.inp-day');
        const vals = document.querySelectorAll('.inp-val');
        let data = [];

        for(let i=0; i<days.length; i++) {
            let d = parseFloat(days[i].value);
            let v = parseFloat(vals[i].value);
            if(!isNaN(d) && !isNaN(v)) {
                data.push({t: d, h: v});
            }
        }

        // æ’åº
        data.sort((a, b) => a.t - b.t);

        if(data.length < 2) {
            alert("è«‹è‡³å°‘è¼¸å…¥å…©ç­†æ•¸æ“šï¼");
            return;
        }

        // åƒæ•¸
        const limitAlert = parseFloat(document.getElementById('limit-alert').value);
        const limitAction = parseFloat(document.getElementById('limit-action').value);

        // è¨ˆç®—åˆå§‹é«˜ç¨‹
        const h0 = data[0].h;
        
        // åˆ†ææœ€å¾Œä¸€æ®µå€é–“
        const last = data[data.length-1];
        const prev = data[data.length-2];
        
        const dt = last.t - prev.t;
        const dh = Math.abs(last.h - prev.h); // å–çµ•å°å€¼çœ‹è®ŠåŒ–é‡
        const totalSettle = (last.h - h0) * 1000; // mm

        // é€Ÿç‡ mm/day
        let velocity = 0;
        if (dt > 0) {
            velocity = (dh * 1000) / dt;
        }

        // è¨ºæ–·ç‹€æ…‹
        const sysStatus = document.getElementById('sys-status');
        const currVel = document.getElementById('curr-vel');
        const totSet = document.getElementById('total-settle');
        const log = document.getElementById('log-content');

        currVel.innerText = velocity.toFixed(2);
        totSet.innerText = totalSettle.toFixed(1);

        let logText = "";
        
        // åˆ¤æ–·é‚è¼¯
        if (velocity >= limitAction) {
            sysStatus.innerHTML = "DANGER / è¡Œå‹•å€¼è¶…æ¨™";
            sysStatus.className = "stat-val status-danger";
            logText += `[CRITICAL] é€Ÿç‡ ${velocity.toFixed(2)} > ${limitAction} mm/day. çµæ§‹å¯èƒ½å¤±ç©©ï¼Œç«‹å³åœå·¥æª¢æŸ¥ï¼`;
        } else if (velocity >= limitAlert) {
            sysStatus.innerHTML = "WARNING / è­¦æˆ’å€¼è¶…æ¨™";
            sysStatus.className = "stat-val status-warn";
            logText += `[WARN] é€Ÿç‡ ${velocity.toFixed(2)} > ${limitAlert} mm/day. éœ€å¢åŠ ç›£æ¸¬é »ç‡ã€‚`;
        } else {
            sysStatus.innerHTML = "NORMAL / ç©©å®š";
            sysStatus.className = "stat-val status-ok";
            logText += `[OK] é€Ÿç‡ ${velocity.toFixed(2)} mm/day. åœ¨å®¹è¨±ç¯„åœå…§ã€‚`;
        }

        // åŠ é€Ÿåº¦è¶¨å‹¢ (å¦‚æœæœ‰3é»ä»¥ä¸Š)
        if (data.length >= 3) {
            const prev2 = data[data.length-3];
            const dt2 = prev.t - prev2.t;
            const dh2 = Math.abs(prev.h - prev2.h);
            const v_prev = (dt2 > 0) ? (dh2 * 1000) / dt2 : 0;
            
            const accel = velocity - v_prev;
            logText += `<br>[TREND] åŠ é€Ÿåº¦: ${accel > 0 ? "+" : ""}${accel.toFixed(2)} mm/dayÂ² (${accel > 0 ? "åŠ é€Ÿè®Šå½¢ä¸­ âš ï¸" : "è¶¨æ–¼æ”¶æ–‚ âœ…"})`;
        }

        log.innerHTML = logText;
        document.getElementById('dashboard').style.display = 'grid';
    }

    // åˆå§‹åŒ–
    init();
</script>

</body>
</html>