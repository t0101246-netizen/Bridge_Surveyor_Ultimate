<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 01: æ¸¬é‡èˆ‡çœŸå€¼çš„è·é›¢â€”â€”èª¤å·®å‚³æ’­å®šå¾‹</title>
    <style>
        :root {
            --bg-theory: #f0f9ff;
            --bg-field: #fffaf0;
            --bg-tool: #1a202c;
            --text-main: #334155;
            --text-light: #f8fafc;
            --accent-blue: #0ea5e9;
            --accent-orange: #f97316;
            --border-color: #cbd5e1;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: "Microsoft JhengHei", "Segoe UI", sans-serif;
            background-color: #f1f5f9;
            color: var(--text-main);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* å¤§æ°£æ’ç‰ˆå®¹å™¨ */
        .container {
            width: 98%;
            max-width: 1920px;
            margin: 0 auto;
            padding: 20px 0;
            display: grid;
            grid-template-columns: 1fr 1fr; /* 50% - 50% åˆ†å‰² */
            gap: 20px;
            align-items: start;
        }

        /* æ¨™é¡Œå€ */
        header {
            grid-column: 1 / -1;
            background: white;
            padding: 2rem;
            border-bottom: 4px solid var(--accent-blue);
            margin-bottom: 10px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1 { font-size: 36px; font-weight: 800; color: #1e293b; letter-spacing: -0.025em; }
        h2 { font-size: 28px; margin-top: 1.5rem; margin-bottom: 1rem; border-left: 5px solid; padding-left: 15px; }
        h3 { font-size: 24px; margin-top: 1rem; color: #475569; }
        p, li { font-size: 22px; margin-bottom: 1rem; text-align: justify; }
        
        /* å·¦æ¬„ï¼šç†è«–èˆ‡åœ–è§£ */
        .theory-column {
            background-color: var(--bg-theory);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .theory-column h2 { border-color: var(--accent-blue); color: #0369a1; }

        /* å³æ¬„ï¼šå¯¦å‹™èˆ‡å·¥å…· */
        .field-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .field-panel {
            background-color: var(--bg-field);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .field-panel h2 { border-color: var(--accent-orange); color: #c2410c; }

        /* å·¥å…·é¢æ¿ (æ·±è‰²é¢¨æ ¼) */
        .tool-panel {
            background-color: var(--bg-tool);
            color: var(--text-light);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
            position: sticky; /* æ‡¸æµ®æ•ˆæœ */
            top: 20px;
        }

        .tool-panel h2 { border-color: var(--accent-blue); color: var(--accent-blue); }
        .tool-panel p { color: #94a3b8; font-size: 18px; }

        /* SVG å®¹å™¨ */
        .svg-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        /* æ•¸å­¸å…¬å¼å¡ç‰‡ */
        .math-card {
            background: white;
            padding: 20px;
            border-left: 4px solid var(--accent-blue);
            font-family: "Times New Roman", serif;
            font-style: italic;
            font-size: 24px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* è¼¸å…¥æ¡†èˆ‡æŒ‰éˆ•æ¨£å¼ */
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 16px; margin-bottom: 5px; color: #cbd5e1; }
        input[type="number"] {
            width: 100%;
            padding: 12px;
            background: #334155;
            border: 1px solid #475569;
            color: white;
            border-radius: 6px;
            font-size: 18px;
        }
        input[type="number"]:focus { outline: 2px solid var(--accent-blue); border-color: transparent; }

        .btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 18px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: background 0.2s;
        }
        .btn:hover { background: #0284c7; }
        .btn-secondary { background: #475569; margin-top: 10px; }

        .result-box {
            background: #0f172a;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: "Consolas", monospace;
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            border-bottom: 1px solid #334155;
            padding-bottom: 5px;
        }
        .result-value { color: var(--accent-blue); font-weight: bold; }
        .pass { color: #22c55e; }
        .fail { color: #ef4444; }

        /* RWD è™•ç† */
        @media (max-width: 1200px) {
            .container { grid-template-columns: 1fr; }
            .tool-panel { position: static; }
        }
    </style>
</head>
<body>

<header>
    <h1>Lesson 01: æ¸¬é‡èˆ‡çœŸå€¼çš„è·é›¢ â€” èª¤å·®å‚³æ’­å®šå¾‹</h1>
    <p style="color: #64748b; font-size: 18px; margin-bottom: 0;">Road to Expert: æŒæ¡æ•¸æ“šçš„éˆé­‚ï¼Œæ‰èƒ½é§•é¦­å·¨å¤§çš„çµæ§‹ã€‚</p>
</header>

<div class="container">
    <div class="theory-column">
        
        <h2>ğŸ¯ ç›´è§€è­¬å–»ï¼šæ‰“é¶çš„å“²å­¸</h2>
        <p>æƒ³åƒä½ åœ¨ç©å°„æ“ŠéŠæˆ²ã€‚æ¸¬é‡æ•¸æ“šå°±åƒä½ æ‰“åœ¨é¶ä¸Šçš„å½ˆå­”ï¼Œã€ŒçœŸå€¼ã€(True Value) å°±æ˜¯é¶å¿ƒã€‚</p>
        <ul>
            <li><strong>ç²¾ç¢ºåº¦ (Precision)ï¼š</strong> ä½ çš„æ‰‹å¾ˆç©©ï¼Œæ‰€æœ‰å­å½ˆéƒ½æ‰“åœ¨åŒä¸€å€‹é»ä¸Šï¼ˆå½ˆå­”å¾ˆå¯†é›†ï¼‰ï¼Œä½†ä¸ä¸€å®šåœ¨é¶å¿ƒã€‚é€™å«ã€Œå¶ç„¶èª¤å·®å°ã€ã€‚</li>
            <li><strong>æº–ç¢ºåº¦ (Accuracy)ï¼š</strong> ä½ çš„å½ˆå­”é›–ç„¶åˆ†æ•£ï¼Œä½†å¹³å‡èµ·ä¾†å‰›å¥½åœ¨é¶å¿ƒã€‚</li>
        </ul>
        <p><strong>æ©‹æ¨‘æ¸¬é‡çš„çµ‚æ¥µç›®æ¨™ï¼š</strong> å…ˆæ±‚ç²¾ç¢ºï¼ˆæ‰‹ç©©ï¼‰ï¼Œå†æ±‚æº–ç¢ºï¼ˆæ ¡æ­£ç„æº–é¡ï¼‰ã€‚å¦‚æœæ‰‹ä¸ç©©ï¼ˆæ•¸æ“šäº‚è·³ï¼‰ï¼Œå°±ç®—ç„æº–é¡å†å¥½ä¹Ÿæ²’ç”¨ã€‚</p>

        <h2>ğŸ‘ï¸ è¦–è¦ºåœ–è§£ï¼šèª¤å·®çš„å½¢ç‹€</h2>
        <div class="svg-container">
            <svg viewBox="0 0 800 300" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L9,3 z" fill="#333" />
                    </marker>
                </defs>

                <g transform="translate(150, 150)">
                    <circle cx="0" cy="0" r="100" fill="none" stroke="#cbd5e1" stroke-width="2"/>
                    <circle cx="0" cy="0" r="70" fill="none" stroke="#cbd5e1" stroke-width="2"/>
                    <circle cx="0" cy="0" r="40" fill="none" stroke="#cbd5e1" stroke-width="2"/>
                    <circle cx="0" cy="0" r="10" fill="#ef4444" opacity="0.5"/>
                    <text x="-60" y="130" font-size="16" fill="#333" text-anchor="middle">ä½ç²¾ç¢ºåº¦ (æ•£äº‚)</text>
                    <circle cx="-30" cy="-40" r="3" fill="#0369a1"/>
                    <circle cx="50" cy="20" r="3" fill="#0369a1"/>
                    <circle cx="-10" cy="60" r="3" fill="#0369a1"/>
                    <circle cx="20" cy="-50" r="3" fill="#0369a1"/>
                </g>

                <g transform="translate(400, 150)">
                    <circle cx="0" cy="0" r="100" fill="none" stroke="#cbd5e1" stroke-width="2"/>
                    <circle cx="0" cy="0" r="70" fill="none" stroke="#cbd5e1" stroke-width="2"/>
                    <circle cx="0" cy="0" r="40" fill="none" stroke="#cbd5e1" stroke-width="2"/>
                    <circle cx="0" cy="0" r="10" fill="#ef4444" opacity="0.5"/>
                    <text x="0" y="130" font-size="16" fill="#333" text-anchor="middle">é«˜ç²¾ç¢ºåº¦ä½†ä½æº–ç¢ºåº¦ (ç³»çµ±èª¤å·®)</text>
                    <circle cx="50" cy="-50" r="3" fill="#0369a1"/>
                    <circle cx="55" cy="-45" r="3" fill="#0369a1"/>
                    <circle cx="48" cy="-52" r="3" fill="#0369a1"/>
                    <circle cx="52" cy="-48" r="3" fill="#0369a1"/>
                </g>

                <g transform="translate(650, 150)">
                    <line x1="-100" y1="100" x2="100" y2="100" stroke="#333" stroke-width="2"/>
                    <line x1="0" y1="100" x2="0" y2="-100" stroke="#333" stroke-width="2"/>
                    <path d="M-100 95 Q -50 95, 0 -80 Q 50 95, 100 95" fill="none" stroke="#f97316" stroke-width="3"/>
                    <text x="0" y="130" font-size="16" fill="#333" text-anchor="middle">å¸¸æ…‹åˆ†ä½ˆ (å¶ç„¶èª¤å·®)</text>
                    <line x1="0" y1="-80" x2="40" y2="-80" stroke="#999" stroke-dasharray="4"/>
                    <text x="50" y="-75" font-size="12" fill="#666">Î¼ (çœŸå€¼)</text>
                </g>
            </svg>
            <p style="font-size: 16px; color: #64748b; margin-top: 10px;">åœ–è§£ï¼šå·¦ç‚ºå¶ç„¶èª¤å·®å¤§ï¼Œä¸­ç‚ºç³»çµ±èª¤å·®ï¼ˆå„€å™¨æœªæ ¡æ­£ï¼‰ï¼Œå³ç‚ºç†æƒ³çš„èª¤å·®åˆ†ä½ˆã€‚</p>
        </div>

        <h2>ğŸ“ ç¡¬æ ¸ç†è«–ï¼šç‚ºä»€éº¼è¦ç®—æ¨™æº–å·®ï¼Ÿ</h2>
        <p>åœ¨è·¯æ©‹å·¥ç¨‹ä¸­ï¼Œæˆ‘å€‘æ°¸é ç„¡æ³•çŸ¥é“ã€ŒçœŸå€¼ã€ã€‚æˆ‘å€‘åªèƒ½é€éç„¡é™æ¬¡çš„è§€æ¸¬å»é€¼è¿‘å®ƒã€‚æ ¹æ“š<strong>æœ€å°äºŒä¹˜æ³• (Least Squares Principle)</strong>ï¼Œæœ€æˆ–æ˜¯å€¼ï¼ˆæœ€æ¥è¿‘çœŸå€¼çš„æ•¸ï¼‰å°±æ˜¯ç®—è¡“å¹³å‡æ•¸ã€‚</p>
        
        <p>ä½†é€™å€‹å¹³å‡æ•¸å¯ä¿¡å—ï¼Ÿæˆ‘å€‘å¿…é ˆè¨ˆç®—<strong>æ¨™æº–å·® (RMSE, Ïƒ)</strong>ã€‚</p>

        <div class="math-card">
            Ïƒ = Â± âˆš( [vv] / (n - 1) )
        </div>
        <p><strong>æ·±åº¦è§£æï¼šç‚ºä»€éº¼æ˜¯ n-1 è€Œä¸æ˜¯ nï¼Ÿ</strong><br>
        å› ç‚ºæˆ‘å€‘æ˜¯ç”¨ã€Œæ¨£æœ¬ã€ä¾†æ¨ä¼°ã€Œæ¯é«”ã€ã€‚ç•¶æˆ‘å€‘è¨ˆç®—å¹³å‡å€¼æ™‚ï¼Œå·²ç¶“æ¶ˆè€—æ‰äº†ä¸€å€‹ã€Œè‡ªç”±åº¦ã€(Degree of Freedom)ã€‚å¦‚æœåªæœ‰ 1 å€‹è§€æ¸¬å€¼ï¼Œæˆ‘å€‘å®Œå…¨ç„¡æ³•åˆ¤æ–·èª¤å·®ï¼ˆåˆ†æ¯ç‚º 0ï¼Œèª¤å·®ç„¡é™å¤§ï¼‰ï¼Œé€™åœ¨æ•¸å­¸ä¸Šè§£é‡‹äº†ç‚ºä»€éº¼<strong>ã€Œå­¤è­‰ä¸ç«‹ã€</strong>ã€‚</p>

        <h3>æ¬Šé‡ (Weight) çš„æ¦‚å¿µ</h3>
        <p>ä¸¦éæ‰€æœ‰æ¸¬é‡éƒ½æ˜¯å¹³ç­‰çš„ã€‚
        <br>- è·¯ç·š Aï¼šæ¸¬äº† 10 å…¬é‡Œã€‚
        <br>- è·¯ç·š Bï¼šæ¸¬äº† 2 å…¬é‡Œã€‚
        <br>é¡¯ç„¶ B çš„ç²¾åº¦è¼ƒé«˜ã€‚åœ¨æ°´æº–æ¸¬é‡ä¸­ï¼Œæ¬Šé‡ P èˆ‡è·é›¢ S æˆåæ¯”ï¼š<strong>P âˆ 1/S</strong>ã€‚åœ¨è¨ˆç®—å¹³å‡å€¼æ™‚ï¼Œå¿…é ˆçµ¦çŸ­è·é›¢çš„è§€æ¸¬å€¼æ›´é«˜çš„ã€Œè©±èªæ¬Šã€ã€‚</p>
    </div>

    <div class="field-column">
        
        <div class="field-panel">
            <h2>ğŸ‘· ä¸»ä»»çš„å°è¬›æ©Ÿï¼šå·¥åœ°ç¾å ´å¯¦æˆ°</h2>
            
            <h3>1. ç‚ºä»€éº¼ä¸€å®šè¦æ¸¬ã€Œå›ã€ï¼Ÿ</h3>
            <p>å³ä½¿æ˜¯å…¨ç«™å„€é€™éº¼å…ˆé€²çš„å„€å™¨ï¼Œæˆ‘å€‘ä»å …æŒã€Œæ­£é¡ã€å€’é¡ã€å„æ¸¬ä¸€æ¬¡å–å¹³å‡ã€‚ç‚ºä»€éº¼ï¼Ÿ
            <br>é€™æ˜¯ç‚ºäº†æ¶ˆé™¤<strong>è¦–æº–è»¸èª¤å·® (Systematic Error)</strong>ã€‚æ­£é¡åå·¦ï¼Œå€’é¡å°±æœƒåå³ï¼Œå…©è€…å¹³å‡ï¼Œèª¤å·®ç‰©ç†æ€§æŠµéŠ·ã€‚é€™æ¯”äº‹å¾Œç”¨æ•¸å­¸ä¿®æ­£æ›´å¯é ã€‚</p>

            <h3>2. å‰”é™¤ã€Œç²—å·®ã€(Blunders)</h3>
            <p>å¦‚æœåœ¨è¨ˆç®—æ¨™æº–å·®æ™‚ï¼Œç™¼ç¾æŸå€‹æ•¸æ“šçš„æ®˜å·® (v) è¶…é <strong>3å€æ¨™æº–å·® (3Ïƒ)</strong>ï¼Œé€™ä¸æ˜¯èª¤å·®ï¼Œé€™æ˜¯<strong>éŒ¯èª¤</strong>ï¼ˆä¾‹å¦‚è®€éŒ¯æ•¸ã€è…³æ¶è¢«è¸¢åˆ°ï¼‰ã€‚æ ¹æ“šçµ±è¨ˆå­¸ï¼Œç™¼ç”Ÿ 3Ïƒ çš„æ©Ÿç‡åªæœ‰ 0.3%ï¼Œåœ¨å·¥åœ°ç¾å ´æˆ‘å€‘è¦–ç‚ºã€Œä¸å¯èƒ½ç™¼ç”Ÿã€ï¼Œå¿…é ˆç›´æ¥åˆªé™¤è©²æ•¸æ“šé‡ç®—ã€‚</p>

            <blockquote>
                <strong>å°ˆå®¶å¿ƒæ³•ï¼š</strong> åˆ¥è¿·ä¿¡å„€å™¨é¡¯ç¤ºçš„ 0.1mmã€‚é™½å…‰ä¸‹çš„ç†±é–ƒçˆ (Heat Shimmer) å¯èƒ½é€ æˆ 2-3mm çš„æµ®å‹•ã€‚åœ¨çƒˆæ—¥ä¸‹çš„æŸæ²¹è·¯é¢æ¸¬é‡ï¼Œè«‹å‹™å¿…ç¸®çŸ­è¦–è·ï¼Œæˆ–è€…æ”¹åœ¨æ¸…æ™¨/å‚æ™šä½œæ¥­ã€‚
            </blockquote>
        </div>

        <div class="tool-panel">
            <h2>ğŸ§® äº’å‹•å·¥å…·ï¼šæ¬Šé‡è§€æ¸¬åˆ†æå™¨</h2>
            <p>è¼¸å…¥å¤šç­†è§€æ¸¬æ•¸æ“šï¼Œè‡ªå‹•è¨ˆç®—åŠ æ¬Šå¹³å‡èˆ‡ç²¾åº¦ï¼Œä¸¦é€²è¡Œ 3Ïƒ æª¢æ ¸ã€‚</p>
            
            <div id="inputs-container">
                <div class="input-group">
                    <label>è§€æ¸¬å€¼ 1 (Value)</label>
                    <input type="number" class="obs-val" placeholder="ä¾‹å¦‚ï¼š10.532" step="0.001">
                    <label style="margin-top:5px; font-size:14px; color:#94a3b8;">æ¬Šé‡ 1 (Weight, é è¨­ 1)</label>
                    <input type="number" class="obs-weight" value="1" step="0.1">
                </div>
                <div class="input-group">
                    <label>è§€æ¸¬å€¼ 2</label>
                    <input type="number" class="obs-val" placeholder="ä¾‹å¦‚ï¼š10.535" step="0.001">
                    <label style="margin-top:5px; font-size:14px; color:#94a3b8;">æ¬Šé‡ 2</label>
                    <input type="number" class="obs-weight" value="1" step="0.1">
                </div>
            </div>

            <button class="btn btn-secondary" onclick="addInputRow()">+ æ–°å¢è§€æ¸¬æ•¸æ“š</button>
            <button class="btn" onclick="calculate()" style="margin-top: 15px;">é–‹å§‹è¨ˆç®—èˆ‡æª¢æ ¸</button>

            <div class="result-box" id="result-display" style="display:none;">
                <div class="result-item">
                    <span>åŠ æ¬Šå¹³å‡å€¼ (XÌ„):</span>
                    <span class="result-value" id="res-mean">--</span>
                </div>
                <div class="result-item">
                    <span>å–®ä½æ¬Šä¸­èª¤å·® (Ïƒâ‚€):</span>
                    <span class="result-value" id="res-sigma0">--</span>
                </div>
                <div class="result-item">
                    <span>å¹³å‡å€¼ä¸­èª¤å·® (Ïƒ xÌ„):</span>
                    <span class="result-value" id="res-sigmax">--</span>
                </div>
                <div style="border-top: 1px solid #334155; margin-top: 10px; padding-top: 10px;">
                    <span style="display:block; margin-bottom: 5px; color: #cbd5e1;">ç²—å·®æª¢æ ¸ (3Ïƒ æº–å‰‡):</span>
                    <div id="qa-log" style="font-size: 14px; color: #94a3b8;"></div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    function addInputRow() {
        const container = document.getElementById('inputs-container');
        const count = container.children.length / 2 + 1; // ç°¡å–®è¨ˆç®—
        
        const div = document.createElement('div');
        div.className = 'input-group';
        div.innerHTML = `
            <label>è§€æ¸¬å€¼ ${Math.floor(count)}</label>
            <input type="number" class="obs-val" placeholder="è¼¸å…¥æ•¸å€¼" step="0.001">
            <label style="margin-top:5px; font-size:14px; color:#94a3b8;">æ¬Šé‡ ${Math.floor(count)}</label>
            <input type="number" class="obs-weight" value="1" step="0.1">
        `;
        container.appendChild(div);
    }

    function calculate() {
        const valInputs = document.querySelectorAll('.obs-val');
        const weightInputs = document.querySelectorAll('.obs-weight');
        let data = [];

        // æ”¶é›†æ•¸æ“š
        for(let i=0; i<valInputs.length; i++) {
            const val = parseFloat(valInputs[i].value);
            const w = parseFloat(weightInputs[i].value);
            if (!isNaN(val) && !isNaN(w)) {
                data.push({ v: val, w: w, id: i+1 });
            }
        }

        if (data.length < 2) {
            alert("è«‹è‡³å°‘è¼¸å…¥å…©ç­†æ•¸æ“šä»¥è¨ˆç®—èª¤å·®ï¼");
            return;
        }

        // 1. è¨ˆç®—åŠ æ¬Šå¹³å‡ XÌ„ = Î£(pv) / Î£p
        let sumPW = 0;
        let sumP = 0;
        data.forEach(d => {
            sumPW += d.v * d.w;
            sumP += d.w;
        });
        let weightedMean = sumPW / sumP;

        // 2. è¨ˆç®—æ®˜å·® v = x - XÌ„ èˆ‡ Î£pvÂ²
        let sumPV2 = 0;
        let qaLog = "";
        let maxV = 0;
        
        data.forEach(d => {
            let residual = d.v - weightedMean;
            sumPV2 += d.w * (residual * residual);
        });

        // 3. è¨ˆç®—å–®ä½æ¬Šä¸­èª¤å·® sigma0 = âˆš(Î£pvÂ² / (n-1))
        let n = data.length;
        let sigma0 = Math.sqrt(sumPV2 / (n - 1));

        // 4. è¨ˆç®—å¹³å‡å€¼ä¸­èª¤å·® sigma_x = sigma0 / âˆšÎ£p
        let sigmaMean = sigma0 / Math.sqrt(sumP);

        // 5. 3Ïƒ æª¢æ ¸é‚è¼¯
        let isClean = true;
        let limit = 3 * sigma0; // 3å€å–®ä½æ¬Šæ¨™æº–å·®ä½œç‚ºå–®æ¬¡è§€æ¸¬çš„å®¹è¨±æ¥µé™
        
        qaLog += `<p>æª¢æ ¸æ¨™æº– (3Ïƒâ‚€): Â±${(limit).toFixed(4)}</p>`;
        
        data.forEach(d => {
            let residual = d.v - weightedMean;
            let residualAbs = Math.abs(residual);
            let status = residualAbs > limit ? "<span class='fail'>[å‰”é™¤]</span>" : "<span class='pass'>[åˆæ ¼]</span>";
            if (residualAbs > limit) isClean = false;
            
            qaLog += `<p>è§€æ¸¬ ${d.id}: æ®˜å·® ${residual.toFixed(4)} ... ${status}</p>`;
        });

        if (!isClean) {
            qaLog += `<p style='color:#ef4444; margin-top:5px;'><strong>âš ï¸ è­¦å‘Šï¼šç™¼ç¾ç²—å·®ï¼å»ºè­°å‰”é™¤ç•°å¸¸å€¼å¾Œé‡ç®—ã€‚</strong></p>`;
        } else {
            qaLog += `<p style='color:#22c55e; margin-top:5px;'><strong>âœ… æ‰€æœ‰æ•¸æ“šçš†åœ¨çµ±è¨ˆå®¹è¨±ç¯„åœå…§ã€‚</strong></p>`;
        }

        // é¡¯ç¤ºçµæœ
        document.getElementById('res-mean').innerText = weightedMean.toFixed(5);
        document.getElementById('res-sigma0').innerText = "Â±" + sigma0.toFixed(5);
        document.getElementById('res-sigmax').innerText = "Â±" + sigmaMean.toFixed(5);
        document.getElementById('qa-log').innerHTML = qaLog;
        document.getElementById('result-display').style.display = 'block';
    }
</script>
<!-- NAV SCRIPT START -->
<script>
(function(){
    // è‡ªå‹•ç”Ÿæˆå°è¦½æŒ‰éˆ•
    const total=13; // ç¸½èª²æ•¸
    const page=location.pathname.split("/").pop();
    const num=parseInt(page.match(/lesson(\d+)\.html/i)?.[1]||0);
    if(!num)return;
    
    const prev=num>1?`lesson${String(num-1).padStart(2,'0')}.html`:'index.html';
    const next=num<total?`lesson${String(num+1).padStart(2,'0')}.html`:'#';
    const bg='#0f172a'; const color='white';

    const div=document.createElement('div');
    div.style.cssText="position:fixed;bottom:20px;right:20px;display:flex;gap:10px;z-index:9999;font-family:Consolas,monospace;";
    div.innerHTML=`
        <a href="${prev}" style="background:${bg};color:${color};padding:10px 20px;text-decoration:none;border-radius:30px;box-shadow:0 4px 10px rgba(0,0,0,0.3);font-weight:bold;">â† PREV</a>
        <a href="index.html" style="background:${bg};color:${color};padding:10px 20px;text-decoration:none;border-radius:30px;box-shadow:0 4px 10px rgba(0,0,0,0.3);font-weight:bold;">MENU</a>
        <a href="${next}" style="background:${bg};color:${color};padding:10px 20px;text-decoration:none;border-radius:30px;box-shadow:0 4px 10px rgba(0,0,0,0.3);font-weight:bold;opacity:${num>=total?0.5:1};pointer-events:${num>=total?'none':'auto'}">NEXT â†’</a>
    `;
    document.body.appendChild(div);
})();
</script>
<!-- NAV SCRIPT END -->
</body>

</html>
